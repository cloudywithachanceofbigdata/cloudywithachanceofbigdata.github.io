"use strict";(self.webpackChunkfull_stack_chronicles=self.webpackChunkfull_stack_chronicles||[]).push([[41611],{3905:(e,t,r)=>{r.d(t,{Zo:()=>p,kt:()=>d});var n=r(67294);function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}var l=n.createContext({}),c=function(e){var t=n.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):a(a({},t),e)),r},p=function(e){var t=c(e.components);return n.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var r=e.components,i=e.mdxType,o=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),m=c(r),d=i,f=m["".concat(l,".").concat(d)]||m[d]||u[d]||o;return r?n.createElement(f,a(a({ref:t},p),{},{components:r})):n.createElement(f,a({ref:t},p))}));function d(e,t){var r=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=r.length,a=new Array(o);a[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:i,a[1]=s;for(var c=2;c<o;c++)a[c]=r[c];return n.createElement.apply(null,a)}return n.createElement.apply(null,r)}m.displayName="MDXCreateElement"},42073:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>m,frontMatter:()=>a,metadata:()=>l,toc:()=>p});var n=r(83117),i=(r(67294),r(3905)),o=r(59943);const a={slug:"gitver-an-alternative-versioning-scheme-to-semver-or-calver",title:"Introducing GitVer - an alternative versioning scheme",authors:["jeffreyaven"],draft:!1,image:"/img/blog/gitver-an-alternative-versioning-scheme-to-semver-or-calver.png",tags:["gitver","semver","calver","gitops","versioning","git","github","gitlab","bitbucket","gitflow"],keywords:["gitver","semver","calver","gitops","versioning","git","github","gitlab","bitbucket","gitflow"],description:"This article demonstrates the use of Deno Deploy to serve static text files as non-traditional development artifacts."},s=void 0,l={permalink:"/gitver-an-alternative-versioning-scheme-to-semver-or-calver",editUrl:"https://github.com/stackql/fullstackchronicles.io/edit/main/blog/2023-01-18-gitver-an-alternative-versioning-scheme-to-semver-or-calver/index.md",source:"@site/blog/2023-01-18-gitver-an-alternative-versioning-scheme-to-semver-or-calver/index.md",title:"Introducing GitVer - an alternative versioning scheme",description:"This article demonstrates the use of Deno Deploy to serve static text files as non-traditional development artifacts.",date:"2023-01-18T00:00:00.000Z",formattedDate:"January 18, 2023",tags:[{label:"gitver",permalink:"/tags/gitver"},{label:"semver",permalink:"/tags/semver"},{label:"calver",permalink:"/tags/calver"},{label:"gitops",permalink:"/tags/gitops"},{label:"versioning",permalink:"/tags/versioning"},{label:"git",permalink:"/tags/git"},{label:"github",permalink:"/tags/github"},{label:"gitlab",permalink:"/tags/gitlab"},{label:"bitbucket",permalink:"/tags/bitbucket"},{label:"gitflow",permalink:"/tags/gitflow"}],readingTime:1.745,hasTruncateMarker:!1,authors:[{name:"Jeffrey Aven",title:"Technologist and Cloud Consultant",url:"https://www.linkedin.com/in/jeffreyaven/",imageURL:"https://s.gravatar.com/avatar/f96573d092470c74be233e1dded5376f?s=80",key:"jeffreyaven"}],frontMatter:{slug:"gitver-an-alternative-versioning-scheme-to-semver-or-calver",title:"Introducing GitVer - an alternative versioning scheme",authors:["jeffreyaven"],draft:!1,image:"/img/blog/gitver-an-alternative-versioning-scheme-to-semver-or-calver.png",tags:["gitver","semver","calver","gitops","versioning","git","github","gitlab","bitbucket","gitflow"],keywords:["gitver","semver","calver","gitops","versioning","git","github","gitlab","bitbucket","gitflow"],description:"This article demonstrates the use of Deno Deploy to serve static text files as non-traditional development artifacts."},prevItem:{title:"Yoast (like) JSON-LD Structured Data for Docusaurus",permalink:"/json-ld-structured-data-for-docusaurus"},nextItem:{title:"Use Deno Deploy to Serve Non-Traditional Artifacts",permalink:"/use-deno-deploy-to-serve-non-traditional-artifacts"}},c={authorsImageUrls:[void 0]},p=[{value:"How it works",id:"how-it-works",level:2},{value:"Workflow Example Code",id:"workflow-example-code",level:2}],u={toc:p};function m(e){let{components:t,...r}=e;return(0,i.kt)("wrapper",(0,n.Z)({},u,r,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"With our StackQL Provider Registry, we had an interesting challenge:  "),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Maintain different versions for one or more different documents in the same repo(which were decoupled from releases)"),(0,i.kt)("li",{parentName:"ol"},"Provide dynamic versioning (with no user input required and not dictated by tags)"),(0,i.kt)("li",{parentName:"ol"},"Maintain some traceability to the source repo (pull requests, commit shas, etc)")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://semver.org/"},"SemVer")," required users to make arbitrary decisions on major, minor, and build numbers.  "),(0,i.kt)("p",null,"Although ",(0,i.kt)("a",{parentName:"p",href:"https://calver.org/"},"CalVer")," required less user discretion for the major and minor components, the micro-component was still an arbitrary number.  This was not ideal for our use case.  "),(0,i.kt)("p",null,"As our document versioning was not related to tags, and we have implemented GitFlow (specifically based upon PRs to dev or main) as our release path, we created a new variant scheme... ",(0,i.kt)("strong",{parentName:"p"},"GitVer"),".  "),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"This is completely different from ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/GitTools/GitVersion"},"GitVersion"),", which is a tool to determine the version of a project based on Git history.  ")),(0,i.kt)("p",null,"This scheme is implemented using GitHub as the remote but could easily be adapted to GitLab, Bitbucket, etc.  "),(0,i.kt)("h2",{id:"how-it-works"},"How it works"),(0,i.kt)("p",null,"Each pull request is assigned a version based on the date the PR was raised or merged, and the PR number.   This version (the GitVer) can then be used to version artifacts (which could be pushed to releases if desired).  "),(0,i.kt)("h2",{id:"workflow-example-code"},"Workflow Example Code"),(0,i.kt)("p",null,"This is an example using GitHub actions.  The version is determined automatically within the workflow.  "),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"main.yml")," example:  "),(0,i.kt)(o.Z,{id:"94bcf43ba5deaf088a271d54d2a9c33e",mdxType:"Gist"}),(0,i.kt)("p",null,"The code used to get the relevant PR info is here (",(0,i.kt)("inlineCode",{parentName:"p"},"setup-job.js"),"), the tricky bit is that the PR number presents differently for a pull request open or sync (pushing changes to an open PR) and a merge commit (which is simply a push to a protetcted branch).  See the code below:"),(0,i.kt)(o.Z,{id:"bec7982143a9637f866b7239e8c18130",mdxType:"Gist"}),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("p",{parentName:"admonition"},"you can export some other metadata while you are here like the commit sha, source and target branch, (PR) action, etc.")),(0,i.kt)("p",null,"The code to generate the GitVer for the PR is here (",(0,i.kt)("inlineCode",{parentName:"p"},"get-version.js"),"):  "),(0,i.kt)(o.Z,{id:"659b56d2474ed1fb8944e1c816b28f49",mdxType:"Gist"}),(0,i.kt)("p",null,"You can see it at work here ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/stackql/stackql-provider-registry/blob/dev/.github/workflows/main.yml"},"stackql/stackql-provider-registry")," which builds and deploys ",(0,i.kt)("a",{parentName:"p",href:"https://registry.stackql.io/"},"providers for StackQL"),".   "),(0,i.kt)("p",null,"Thoughts?"))}m.isMDXComponent=!0},59943:(e,t,r)=>{r.d(t,{Z:()=>a});var n=r(67294);r(45697);function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}const a=function(e){function t(){return i(this,t),o(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentDidMount=function(){this._updateIframeContent()},t.prototype.componentDidUpdate=function(e,t){this._updateIframeContent()},t.prototype._defineUrl=function(){var e=this.props,t=e.id,r=e.file;return"https://gist.github.com/"+t+".js"+(r?"?file="+r:"")},t.prototype._updateIframeContent=function(){var e=this.props,t=e.id,r=e.file,n=this.iframeNode,i=n.document;n.contentDocument?i=n.contentDocument:n.contentWindow&&(i=n.contentWindow.document);var o='<html><head><base target="_parent"><style>*{font-size:12px;}</style></head><body '+("onload=\"parent.document.getElementById('"+(r?"gist-"+t+"-"+r:"gist-"+t)+"').style.height=document.body.scrollHeight + 'px'\"")+">"+('<script type="text/javascript" src="'+this._defineUrl()+'"><\/script>')+"</body></html>";i.open(),i.writeln(o),i.close()},t.prototype.render=function(){var e=this,t=this.props,r=t.id,i=t.file;return n.createElement("iframe",{ref:function(t){e.iframeNode=t},width:"100%",frameBorder:0,id:i?"gist-"+r+"-"+i:"gist-"+r})},t}(n.PureComponent)}}]);