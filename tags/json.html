<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-tags-post-list-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.0">
<title data-rh="true">2 posts tagged with &quot;json&quot; | Full Stack Chronicles</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://fullstackchronicles.io/img/fullstackchronicles-cover-image.png"><meta data-rh="true" name="twitter:image" content="https://fullstackchronicles.io/img/fullstackchronicles-cover-image.png"><meta data-rh="true" property="og:url" content="https://fullstackchronicles.io/tags/json"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="robots" content="index,follow"><meta data-rh="true" name="twitter:site" content="@fschronicles1"><meta data-rh="true" name="twitter:creator" content="@fschronicles1"><meta data-rh="true" name="og:type" content="website"><meta data-rh="true" name="og:locale" content="en_US"><meta data-rh="true" name="og:site_name" content="Full Stack Chronicles"><meta data-rh="true" name="msapplication-TileColor" content="#2d89ef"><meta data-rh="true" name="theme-color" content="#ffffff"><meta data-rh="true" property="og:title" content="2 posts tagged with &quot;json&quot; | Full Stack Chronicles"><meta data-rh="true" name="docusaurus_tag" content="blog_tags_posts"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_tags_posts"><link data-rh="true" rel="icon" href="/favicon.ico"><link data-rh="true" rel="canonical" href="https://fullstackchronicles.io/tags/json"><link data-rh="true" rel="alternate" href="https://fullstackchronicles.io/tags/json" hreflang="en"><link data-rh="true" rel="alternate" href="https://fullstackchronicles.io/tags/json" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://MZCGVO503N-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/rss.xml" title="Full Stack Chronicles Blog Feed RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="Full Stack Chronicles Blog Feed Atom Feed">
<link rel="alternate" type="application/json" href="/feed.json" title="Full Stack Chronicles Blog Feed JSON Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0FVDC1E8G6"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-0FVDC1E8G6",{})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Full Stack Chronicles" href="/opensearch.xml">



<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#0f4c81"><link rel="stylesheet" href="/assets/css/styles.308152d6.css">
<link rel="preload" href="/assets/js/runtime~main.a32e99fc.js" as="script">
<link rel="preload" href="/assets/js/main.3c68341f.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#A9BCD0;color:#1A4E82" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY"><b>If you find our content useful, follow us on <a target="_blank" rel="noopener noreferrer" href="https://github.com/stackql">GitHub</a>, if you have some content to share, reach out</b></div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_m1mJ navbar--primary"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/full-stack-logo-transparent.svg" alt="Full Stack Chronicles" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/full-stack-logo-transparent.svg" alt="Full Stack Chronicles" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Full Stack Chronicles</b></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Home</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/tags">Topics</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/tags">All Topics</a></li><li><a class="dropdown__link" href="/tags/gcp">Google Cloud Platform</a></li><li><a class="dropdown__link" href="/tags/aws">AWS</a></li><li><a class="dropdown__link" href="/tags/azure">Azure</a></li><li><a class="dropdown__link" href="/tags/snowflake">Snowflake</a></li><li><a class="dropdown__link" href="/tags/okta">Okta</a></li><li><a class="dropdown__link" href="/tags/openapi">OpenAPI</a></li><li><a class="dropdown__link" href="/tags/spark">Spark</a></li><li><a class="dropdown__link" href="/tags/kafka">Kafka</a></li><li><a class="dropdown__link" href="/tags/ci-cd">CI/CD</a></li></ul></div><a class="navbar__item navbar__link" href="/archive">Archive</a><a href="https://github.com/stackql/fullstackchronicles.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent Posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/enhancing-dbt-snapshots-with-operational-metadata">Enhancing dbt Snapshots with Operational Metadata</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/json-ld-structured-data-for-docusaurus">Yoast (like) JSON-LD Structured Data for Docusaurus</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/gitver-an-alternative-versioning-scheme-to-semver-or-calver">Introducing GitVer - an alternative versioning scheme</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/use-deno-deploy-to-serve-non-traditional-artifacts">Use Deno Deploy to Serve Non-Traditional Artifacts</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/apache-beam-in-five-minutes">Apache Beam in Five Minutes</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/aws-iam-vs-google-iam">AWS IAM vs Google IAM</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/create-and-use-custom-magic-commands-in-jupyter">Create and use Custom Magic Commands in Jupyter</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/deno-in-five-minutes">Deno in 5 Minutes</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/dbt-in-five-minutes">DBT in 5 Minutes</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/loading-parquet-files-into-snowflake">Loading Parquet Files into Snowflake</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/analyze-developer-activity-with-stackql-jupyter-bigquery">Analyze Developer Activity with StackQL, Jupyter and BigQuery</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/converting-google-discovery-docs-to-openapi3-specs">Converting Google Discovery Docs to OpenAPI3 Specs</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/recurse-javascript-object-to-get-values-for-a-given-key-the-easy-way">Recurse JavaScript Object to Get Values for a Given Key the Easy Way</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/dataops-with-container-images-and-multi-stage-builds">DataOps with Container Images and Multi-Stage Builds</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/using-the-snowflake-sql-api-with-typescript">Using the Snowflake SQL API with TypeScript</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><header class="margin-bottom--xl"><h1>2 posts tagged with &quot;json&quot;</h1><a href="/tags">View All Tags</a></header><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><meta itemprop="image" content="https://fullstackchronicles.io/img/fullstackchronicles-cover-image.png"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/using-jsonnet-to-configure-multiple-environments">Using Jsonnet to Configure Multiple Environments</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2021-06-24T00:00:00.000Z" itemprop="datePublished">June 24, 2021</time> · <!-- -->3 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/mpstella" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="http://1.gravatar.com/avatar/9a7465656212285f24f64326cd38d6c9?s=80" alt="Mark Stella"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/mpstella" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Mark Stella</span></a></div><small class="avatar__subtitle" itemprop="description">Senior Cloud Engineer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>Everytime I start a new project I try and optimise how the application can work across multiple envronments. For those who don&#x27;t have the luxury of developing everything in docker containers or isolated spaces, you will know my pain. How do I write code that can run on my local <code>dev</code> environment, migrate to the shared <code>test</code> and <code>ci</code> environment and ultimately still work in <code>production</code>.</p><p>In the past I tried exotic options like dynamically generating <code>YAML</code> or <code>JSON</code> using Jinja. I then graduated to <code>HOCON</code> which made my life so much easier. This was until I stumbled across <a href="https://jsonnet.org/" target="_blank" rel="noopener noreferrer">Jsonnet</a>. For those who have not seen this in action, think JSON meets Jinja meets HOCON (a Frankenstein creation that I have actually built in the past)</p><p>To get a feel for how it looks, below is a contrived example where I require 3 environments (dev, test and production) that have different paths, databases and vault configuration.</p><p>Essentially, when this config is run through the Jsonnet templating engine, it will expect a variable &#x27;<code>ENV</code>&#x27; to ultimately refine the <code>environment</code> entry to the one we specifically want to use.</p><p>A helpful thing I like to do with my programs is give users a bit of information as to what environments can be used. For me, running a cli that requires args should be as informative as possible - so listing out all the environments is mandatory. I achieve this with a little trickery and a lot of help from the <a href="https://click.palletsprojects.com/" target="_blank" rel="noopener noreferrer">click</a> package!</p><div class="language-jsonnet codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsonnet codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">local exe = &quot;application.exe&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">local Environment(prefix) = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  root: &quot;/usr/&quot; + prefix + &quot;/app&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  path: self.root + &quot;/bin/&quot; + exe,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  database: std.asciiUpper(prefix) + &quot;_DB&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  tmp_dir: &quot;/tmp/&quot; + prefix</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">local Vault = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  local uri = &quot;http://127.0.0.1:8200/v1/secret/app&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  _: {},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  dev: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      secrets_uri: uri,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      approle: &quot;local&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  tst: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      secrets_uri: uri,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      approle: &quot;local&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  prd: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      secrets_uri: &quot;https://vsrvr:8200/v1/secret/app&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      approle: &quot;sa_user&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  environments: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _: {},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dev: Environment(&quot;dev&quot;) + Vault[std.extVar(&quot;ENV&quot;)],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tst: Environment(&quot;tst&quot;) + Vault[std.extVar(&quot;ENV&quot;)],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    prd: Environment(&quot;prd&quot;) + Vault[std.extVar(&quot;ENV&quot;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  environment: $[&quot;environments&quot;][std.extVar(&quot;ENV&quot;)],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The trick I perform is to have a placeholder entry &#x27;<code>_</code>&#x27; that I use to initially render the template. I then use the generated JSON file and get all the environment keys so I can feed that directly into click.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> typing </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Any</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Dict</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> click</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> _jsonnet</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> pprint </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> pprint</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ENV_JSONNET </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;environment.jsonnet&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ENV_PFX_PLACEHOLDER </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;_&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">parse_environment</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">prefix</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> Dict</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Any</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _json_str </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> _jsonnet</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">evaluate_file</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ENV_JSONNET</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ext_vars</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;ENV&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> prefix</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> json</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loads</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_json_str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_config </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> parse_environment</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">prefix</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">ENV_PFX_PLACEHOLDER</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_env_prefixes </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">k </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> k </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> _config</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;environments&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">keys</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> k </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> ENV_PFX_PLACEHOLDER</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@click</span><span class="token decorator annotation punctuation" style="color:#393A34">.</span><span class="token decorator annotation punctuation" style="color:#393A34">command</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;EnvMgr&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@click</span><span class="token decorator annotation punctuation" style="color:#393A34">.</span><span class="token decorator annotation punctuation" style="color:#393A34">option</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;-e&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;--environment&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    required</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">type</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">click</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Choice</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_env_prefixes</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> case_sensitive</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">help</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;Which environment this is executing on&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">cli</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">environment</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    config </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> parse_environment</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">environment</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pprint</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;environment&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;__main__&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cli</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This now allows me to execute the application with both list checking (has the user selected an allowed environment?) and the autogenerated help that click provides.</p><p>Below shows running the cli with no arguments:</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> python cli.py</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Usage: cli.py </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">OPTIONS</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Try </span><span class="token string" style="color:#e3116c">&#x27;cli.py --help&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> help.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Error: Missing option </span><span class="token string" style="color:#e3116c">&#x27;-e&#x27;</span><span class="token plain"> / </span><span class="token string" style="color:#e3116c">&#x27;--environment&#x27;</span><span class="token builtin class-name">.</span><span class="token plain"> Choose from:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        dev,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        prd,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        tst</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Executing the application with a valid environment:</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> python cli.py -e dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;approle&#x27;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;local&#x27;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;database&#x27;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;DEV_DB&#x27;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;path&#x27;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;/usr/dev/app/bin/application.exe&#x27;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;root&#x27;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;/usr/dev/app&#x27;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;secrets_uri&#x27;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;http://127.0.0.1:8200/v1/secret/app&#x27;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;tmp_dir&#x27;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;/tmp/dev&#x27;</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Executing the application with an invalid environment:</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> python cli.py -e prd3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Usage: cli.py </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">OPTIONS</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Try </span><span class="token string" style="color:#e3116c">&#x27;cli.py --help&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> help.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Error: Invalid value </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;-e&#x27;</span><span class="token plain"> / </span><span class="token string" style="color:#e3116c">&#x27;--environment&#x27;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;prd3&#x27;</span><span class="token plain"> is not one of </span><span class="token string" style="color:#e3116c">&#x27;dev&#x27;</span><span class="token plain">, </span><span class="token string" style="color:#e3116c">&#x27;prd&#x27;</span><span class="token plain">, </span><span class="token string" style="color:#e3116c">&#x27;tst&#x27;</span><span class="token builtin class-name">.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This is only the tip of what Jsonnet can provide, I am continually learning more about the templating engine and the tool.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/ci-cd">ci-cd</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/configuration">configuration</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/envconfig">envconfig</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/environments">environments</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/hocon">hocon</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/json">json</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/jsonnet">jsonnet</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><meta itemprop="image" content="https://fullstackchronicles.io/images/json-go.png"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/json-wrangling-with-go">JSON Wrangling with Go</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2020-04-22T00:00:00.000Z" itemprop="datePublished">April 22, 2020</time> · <!-- -->5 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://www.linkedin.com/in/jeffreyaven/" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://s.gravatar.com/avatar/f96573d092470c74be233e1dded5376f?s=80" alt="Jeffrey Aven"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://www.linkedin.com/in/jeffreyaven/" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Jeffrey Aven</span></a></div><small class="avatar__subtitle" itemprop="description">Technologist and Cloud Consultant</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p><img loading="lazy" alt="JSON Golang" src="data:image/png;base64,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" width="214" height="92" class="img_ev3q"></p><p>Golang is a fantastic language but at first glance it is a bit clumsy when it comes to JSON in contrast to other languages such as Python or Javascript. Having said that once you master the concepts involved with JSON wrangling using Go it is equally as functional – with added type safety and performance.</p><p>In this article we will build a program in Golang to parse a JSON file containing a collection held in a named key – without knowing the structure of this object, we will expose the schema for the object including data types and recurse the object for its values.</p><p>This example uses a great Go package called <code>tablewriter</code> to render the output of these operations using a table style result set.</p><p>The program has <code>describe</code> and <code>select</code> verbs as operation types; describe shows the column names in the collection and their respective data types, select prints the keys and values as a tabular result set with column headers for the keys and rows containing their corresponding values.</p><p>Starting with this:</p><iframe width="100%" frameborder="0" id="gist-cceeb5b667ccfe8a9e20437d3f1dde42"></iframe><p>We will end up with this when performing a <code>describe</code> operation:</p><iframe width="100%" frameborder="0" id="gist-fbd04c220a70d439df3a14d4a4f48a3e"></iframe><p>And this when performing a <code>select</code> operation:</p><iframe width="100%" frameborder="0" id="gist-0b795b13b160cfbcd6796243c0fbb238"></iframe><p>Now let’s talk about how we got there…</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="the-json-package">The JSON package<a href="#the-json-package" class="hash-link" aria-label="Direct link to The JSON package" title="Direct link to The JSON package">​</a></h2><p>Support for JSON in Go is provided using the <code>encoding/json</code> package, this needs to be imported in your program of course… You will also need to import the <code>reflect</code> package – more on this later. <code>io/ioutil</code> is required to read the data from a file input, there are other packages included in the program that are removed for brevity:</p><iframe width="100%" frameborder="0" id="gist-def7e02eac07ded8b80ff807cf023989"></iframe><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="reading-the-data">Reading the data…<a href="#reading-the-data" class="hash-link" aria-label="Direct link to Reading the data…" title="Direct link to Reading the data…">​</a></h2><p>We will read the data from the JSON file into a variable called <code>body</code>, note that we are not attempting to deserialize the data at this point. This is also a good opportunity to handle any runtime or IO errors that occur here as well.</p><iframe width="100%" frameborder="0" id="gist-74a2c2c839a30ed8cc66d83d3ddde3b4"></iframe><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="the-interface">The interface…<a href="#the-interface" class="hash-link" aria-label="Direct link to The interface…" title="Direct link to The interface…">​</a></h2><p>We will declare an empty interface called <code>data</code> which will be used to decode the json object (of which the structure is not known), we will also create an abstract interface called <code>colldata</code> to hold the contents of the collection contained inside the JSON object that we are specifically looking for:</p><iframe width="100%" frameborder="0" id="gist-32555f65af4be1fc2504f2d11e15aa19"></iframe><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="validating">Validating…<a href="#validating" class="hash-link" aria-label="Direct link to Validating…" title="Direct link to Validating…">​</a></h2><p>Next we need to validate that the input is a valid JSON object, we can use the <code>json.Valid(body)</code> method to do this:</p><iframe width="100%" frameborder="0" id="gist-c7afe41fcca4ba1e3ed009044cea76de"></iframe><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="unmarshalling">Unmarshalling…<a href="#unmarshalling" class="hash-link" aria-label="Direct link to Unmarshalling…" title="Direct link to Unmarshalling…">​</a></h2><p>Now the interesting bits, we will deserialize the JSON object to the empty data interface we created earlier using the <code>json.Unmarshal()</code> method:</p><iframe width="100%" frameborder="0" id="gist-2579ec79be915fb89e91ea0977bfbff6"></iframe><p>Note that this operation is another opportunity to catch unexpected errors and handle them accordingly.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="checking-the-type-of-the-object-using-reflection">Checking the type of the object using reflection…<a href="#checking-the-type-of-the-object-using-reflection" class="hash-link" aria-label="Direct link to Checking the type of the object using reflection…" title="Direct link to Checking the type of the object using reflection…">​</a></h2><p>Now that we have serialized the JSON object into the data interface, there are several ways we can inspect the type of the object (which could be a map or an array). One such way is to use reflection. Reflection is the ability of a program to inspect itself at runtime. An example is shown here:</p><iframe width="100%" frameborder="0" id="gist-1ccd077de0fdee8973e25ac79719cbf5"></iframe><p>This instruction would produce the following output for our <code>zones.json</code> file:</p><iframe width="100%" frameborder="0" id="gist-04c1b3ae79e969e4be32ef7fa1c07736"></iframe><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="the-type-switch">The type switch…<a href="#the-type-switch" class="hash-link" aria-label="Direct link to The type switch…" title="Direct link to The type switch…">​</a></h2><p>Another method to decode the type of the data object (and any objects nested as elements or keys within the data object), is to use the type switch, an example of a type switch function is shown here:</p><iframe width="100%" frameborder="0" id="gist-2e7a3d62ec6f7c71a9c01bfa8d360e4e"></iframe><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="finding-the-nested-collection-and-recursing-it">Finding the nested collection and recursing it…<a href="#finding-the-nested-collection-and-recursing-it" class="hash-link" aria-label="Direct link to Finding the nested collection and recursing it…" title="Direct link to Finding the nested collection and recursing it…">​</a></h2><p>The aim of the program is to find a collection (an array of maps) nested in a JSON object. The maps with each element of the array are unknown at runtime and are discovered through recursion.</p><p>If we are performing a describe operation, we only need to parse the first element of the collection to get the key names and the data type of the values (for which we will use the same <code>getObjectType</code> function to perform a type switch.</p><p>If we are performing a select operation, we need to parse the first element to get the column names (the keys in the map) and then we need to recurse each element to get the values for each key.</p><p>If the element contains a key named id or name, we will place this at the beginning of the resultant record, as maps are unordered by definition.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="the-output">The output…<a href="#the-output" class="hash-link" aria-label="Direct link to The output…" title="Direct link to The output…">​</a></h2><p>As mentioned, we are using the <code>tablewriter</code> package to render the output of the collection as a pretty printed table in our terminal. As wrap around can get pretty ugly an additional <code>maxfieldlen</code> argument is provided to truncate the values if needed.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="in-summary">In summary…<a href="#in-summary" class="hash-link" aria-label="Direct link to In summary…" title="Direct link to In summary…">​</a></h2><p>Although it is a bit more involved than some other languages, once you get your head around processing JSON in Go, the possibilities are endless!</p><blockquote><p>Full source code can be found at: <a href="https://github.com/gamma-data/json-wrangling-with-golang" target="_blank" rel="noopener noreferrer">https://github.com/gamma-data/json-wrangling-with-golang</a></p></blockquote></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/golang">golang</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/json">json</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"></nav></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Blog</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/">Home</a></li><li class="footer__item"><a class="footer__link-item" href="/archive">Archive</a></li><li class="footer__item"><a class="footer__link-item" href="/tags">Tags</a></li></ul></div><div class="col footer__col"><div class="footer__title">Sponsors</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackql.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">StackQL<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://gammadata.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Gamma Data<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.windrate.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">WindRate<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/stackql/fullstackchronicles.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div></div></footer></div>
<script src="/assets/js/runtime~main.a32e99fc.js"></script>
<script src="/assets/js/main.3c68341f.js"></script>
</body>
</html>