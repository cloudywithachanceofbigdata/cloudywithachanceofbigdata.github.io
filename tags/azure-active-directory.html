<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-tags-post-list-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.18">
<link rel="alternate" type="application/rss+xml" href="/rss.xml" title="Full Stack Chronicles Blog Feed RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="Full Stack Chronicles Blog Feed Atom Feed">
<link rel="alternate" type="application/json" href="/feed.json" title="Full Stack Chronicles Blog Feed JSON Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0FVDC1E8G6"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-0FVDC1E8G6",{})</script>
<link rel="search" type="application/opensearchdescription+xml" title="Full Stack Chronicles" href="/opensearch.xml"><title data-rh="true">One post tagged with &quot;azure active directory&quot; | Full Stack Chronicles</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://fullstackchronicles.io/img/fullstackchronicles-cover-image.png"><meta data-rh="true" name="twitter:image" content="https://fullstackchronicles.io/img/fullstackchronicles-cover-image.png"><meta data-rh="true" property="og:url" content="https://fullstackchronicles.io/tags/azure-active-directory"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="wot-verification" content="e7522390be4370727fac"><meta data-rh="true" property="og:title" content="One post tagged with &quot;azure active directory&quot; | Full Stack Chronicles"><meta data-rh="true" name="docusaurus_tag" content="blog_tags_posts"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_tags_posts"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://fullstackchronicles.io/tags/azure-active-directory"><link data-rh="true" rel="alternate" href="https://fullstackchronicles.io/tags/azure-active-directory" hreflang="en"><link data-rh="true" rel="alternate" href="https://fullstackchronicles.io/tags/azure-active-directory" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://MZCGVO503N-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.77ea11e8.css">
<link rel="preload" href="/assets/js/runtime~main.f10100e0.js" as="script">
<link rel="preload" href="/assets/js/main.29d6b400.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><div class="announcementBar_IbjG" style="background-color:#A9BCD0;color:#1A4E82" role="banner"><div class="announcementBarPlaceholder_NC_W"></div><div class="announcementBarContent_KsVm"><b>If you find our content useful, give it a ⭐️ on <a target="_blank" rel="noopener noreferrer" href="https://github.com/stackql/fullstackchronicles.io">GitHub</a>, if you want to contribute and become an author, submit a PR</b></div><button type="button" class="clean-btn close announcementBarClose_FG1z" aria-label="Close"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav class="navbar navbar--fixed-top navbarHideable_ObN2 navbar--primary"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/full-stack-logo-transparent.svg" alt="Full Stack Chronicles" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/full-stack-logo-transparent.svg" alt="Full Stack Chronicles" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Full Stack Chronicles</b></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Home</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/tags">Topics</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/tags">All Topics</a></li><li><a class="dropdown__link" href="/tags/gcp">Google Cloud Platform</a></li><li><a class="dropdown__link" href="/tags/aws">AWS</a></li><li><a class="dropdown__link" href="/tags/azure">Azure</a></li><li><a class="dropdown__link" href="/tags/snowflake">Snowflake</a></li><li><a class="dropdown__link" href="/tags/okta">Okta</a></li><li><a class="dropdown__link" href="/tags/openapi">OpenAPI</a></li><li><a class="dropdown__link" href="/tags/spark">Spark</a></li><li><a class="dropdown__link" href="/tags/kafka">Kafka</a></li><li><a class="dropdown__link" href="/tags/ci-cd">CI/CD</a></li></ul></div><a class="navbar__item navbar__link" href="/archive">Archive</a><a href="https://github.com/stackql/fullstackchronicles.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_qEbK"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_a9qW thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_uKok margin-bottom--md">Recent Posts</div><ul class="sidebarItemList_Kvuv"><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/converting-google-discovery-docs-to-openapi3-specs">Converting Google Discovery Docs to OpenAPI3 Specs</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/recurse-javascript-object-to-get-values-for-a-given-key-the-easy-way">Recurse JavaScript Object to Get Values for a Given Key the Easy Way</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/dataops-with-container-images-and-multi-stage-builds">DataOps with Container Images and Multi-Stage Builds</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/using-the-snowflake-sql-api-with-typescript">Using the Snowflake SQL API with TypeScript</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/split-a-large-swagger-openapi-specification-into-smaller-documents">Split a large Open API or Swagger Specification into smaller documents</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/stream-processing-with-spark-structured-streaming-kafka-and-snowflake-using-python">Stream Processing with Spark Structured Streaming, Kafka and Snowflake using Python</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/simple-cli-pkce-auth-using-okta">Simple CLI Application to Login to Okta using PKCE</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/cloudy-with-a-chance-of-big-data-has-moved">Cloudy with a Chance of Big Data has Moved</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/scaling-up-prefect-with-gitstorage">Scaling up Prefect with GitStorage</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/implementing-a-serverless-sftp-gateway-using-the-aws-transfer-family">Implementing a Serverless SFTP Gateway using the AWS Transfer Family</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><header class="margin-bottom--xl"><h1>One post tagged with &quot;azure active directory&quot;</h1><a href="/tags">View All Tags</a></header><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_rzP5" itemprop="headline"><a itemprop="url" href="/simple-sso-with-an-external-idp-using-active-directory-and-okta">Simple SSO with an external IdP using Active Directory and Okta</a></h2><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2022-02-04T00:00:00.000Z" itemprop="datePublished">February 4, 2022</time> · <!-- -->4 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_FlmR"><div class="avatar margin-bottom--sm"><span class="avatar__photo-link avatar__photo"><a href="https://www.linkedin.com/in/jeffreyaven/" target="_blank" rel="noopener noreferrer"><img class="image_o0gy" src="https://s.gravatar.com/avatar/f96573d092470c74be233e1dded5376f?s=80" alt="Jeffrey Aven"></a></span><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://www.linkedin.com/in/jeffreyaven/" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Jeffrey Aven</span></a></div><small class="avatar__subtitle" itemprop="description">Technologist and Cloud Consultant</small></div></div></div></div></header><meta itemprop="image" content="https://fullstackchronicles.io/img/blog/okta-ad-sso-featured-image.png"><div class="markdown" itemprop="articleBody"><p>This article describes a simple SSO pattern for authenticating and authorizing users from an external AD and to your application without requiring federation.  </p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="the-challenge">the Challenge<a class="hash-link" href="#the-challenge" title="Direct link to heading">​</a></h2><p>You need to authenticate external users to use your application, these users belong to an organization using Azure Active Directory with specific login policies (such as password strength and expiry, multi factor authentication, etc).  Your requirements (if you choose to accept them) are:</p><ol><li>You are required to provide SSO to these users using their home AD tenant and policies</li><li>The solution does not include SAML based federation between directories (yours and theirs)</li><li>The solution does not require any changes on the external AD tenant (no new AAD applications, client secrets, etc)</li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="the-solution">the Solution<a class="hash-link" href="#the-solution" title="Direct link to heading">​</a></h2><p>Using an IDAM/IDaaS platform (such as Okta in this case), along with an AAD application (in your AD tenant in your Azure subscription), you can create a local AD app using this magic property to accomplish all of the above requirements (requiring zero changes on the third-party AD).  </p><p><a target="_blank" href="/assets/files/azure-ad-app-registration-9857aa65a9e76e9710d04eb12cf875c2.png"><img loading="lazy" alt="Azure AD App Registration" src="/assets/images/azure-ad-app-registration-9857aa65a9e76e9710d04eb12cf875c2.png" width="849" height="900" class="img_E7b_"></a> </p><p>This is what it looks like using the <code>az</code> cli:</p><iframe width="100%" frameborder="0" id="gist-8b70fbe242da02ca844bf2fe53355743"></iframe><p>the <code>--available-to-other-tenants</code> property is Microsoft&#x27;s way of allowing you to implicitly trust other AAD/Office 365 tenants, meaning the authentication request is passed to the target AD tenant from your application.  </p><p>Here is a context diagram which explains the interactions in the context of a Jamstack application (using a library such as Auth.js).  </p><div class="tabs-container"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LplD tabs__item--active">Overview</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LplD">PlantUML</li></ul><div class="margin-vert--md"><div role="tabpanel"><p><a target="_blank" href="/assets/files/okta-ad-sso-context-diagram-080a3ead154d3ab5f7a1ebb43259f3ed.png"><img loading="lazy" alt="Okta AD SSO Context Diagram" src="/assets/images/okta-ad-sso-context-diagram-080a3ead154d3ab5f7a1ebb43259f3ed.png" width="662" height="571" class="img_E7b_"></a> </p></div><div role="tabpanel" hidden=""><div class="codeBlockContainer_I0IT language-plantuml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-plantuml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">@startuml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!define C4Puml https://raw.githubusercontent.com/RicardoNiepel/C4-PlantUML/master</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!includeurl C4Puml/C4_Context.puml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!includeurl C4Puml/C4_Component.puml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!includeurl C4Puml/C4_Container.puml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;left to right direction</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!define Rel_NoRank(e_from,e_to, e_label=&quot; &quot;) Rel_(e_from,e_to, e_label, &quot;-[norank]-&gt;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!$imgroot = &quot;https://github.com/avensolutions/plantuml-cloud-image-library/raw/main/images&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!unquoted procedure $AzureActiveDirectory($alias, $label, $techn, $descr=&quot;&quot;, $stereo=&quot;Azure Active Directory&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rectangle &quot;==$label\n\n&lt;img:$imgroot/azure/AzureActiveDirectory.png{scale=0.75}&gt;\n//&lt;size:12&gt;[$techn]&lt;/size&gt;//&quot; &lt;&lt;$stereo&gt;&gt; as $alias #white</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!endprocedure</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!unquoted procedure $Okta($alias, $label, $techn, $descr=&quot;&quot;, $stereo=&quot;Okta&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rectangle &quot;==$label\n\n&lt;img:$imgroot/okta/okta.png{scale=1}&gt;\n//&lt;size:12&gt;[$techn]&lt;/size&gt;//&quot; &lt;&lt;$stereo&gt;&gt; as $alias #white</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!endprocedure</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Person(user, User\n&lt;i&gt;UserAgent (Browser) )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Person(admin, Application Admin)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">note right</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Create users in the Okta org with the same email as the users email address in their AD (external AD)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end note</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rectangle &quot;Application Environment&quot; &lt;&lt;boundary&gt;&gt; as app{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $AzureActiveDirectory(localad, Local AD Tenant, Azure Active Directory)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $Okta(okta, Local Okta Org, Okta)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$AzureActiveDirectory(otherad, Azure AD Tenant\n&lt;i&gt;(External AD), Azure Active Directory)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Lay_D(user, okta)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Lay_R(okta, localad)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Lay_R(localad, otherad)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Lay_D(okta, admin)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Rel_U(okta, user, access code)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Rel_D(user, okta, authorize request)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Rel_R(okta, localad, routes to)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Rel_R(localad, otherad, forwards to)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Rel_U(admin, okta, creates users)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@enduml</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="setup-and-configuration">Setup and Configuration<a class="hash-link" href="#setup-and-configuration" title="Direct link to heading">​</a></h2><p>The following flowchart explains the steps involved in setting this up.  The highlighted nodes are part of normal application lifecycle operations as users get created and deactivated.  </p><div class="tabs-container"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LplD tabs__item--active">Flowchart</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LplD">Mermaid</li></ul><div class="margin-vert--md"><div role="tabpanel"><p><a target="_blank" href="/assets/files/okta-ad-sso-setup-flowchart-ae59463b7d2de2881cb11b6b9520f198.svg"><img loading="lazy" alt="Okta AD SSO Setup Flowchart" src="/assets/images/okta-ad-sso-setup-flowchart-ae59463b7d2de2881cb11b6b9520f198.svg" width="749" height="810" class="img_E7b_"></a> </p></div><div role="tabpanel" hidden=""><div class="codeBlockContainer_I0IT language-mermaid theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-mermaid codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">flowchart TD;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  subgraph Local Azure AD;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    a1(1. Create AD App);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  subgraph Okta;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    b1(2. Create IdP)--&gt;b2(3. Create Application);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    b2--&gt;b3(4. Create IdP\nRouting Rule\nfor Application);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    b3--&gt;b4(5. Create Group);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    b4--&gt;b5(6. Assign Group\nto Application);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    b5--&gt;c1(7. Create User);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c1--&gt;c2(8. Add User to Group);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    style c1 fill:#f9f,stroke:#333,stroke-width:4px;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    style c2 fill:#f9f,stroke:#333,stroke-width:4px;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  subgraph Application;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    d1(9. Configure ISSUER\nand CLIENTID);      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  a1--&gt;Okta;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  b3--&gt;Application;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="authorisation-flow">Authorisation flow<a class="hash-link" href="#authorisation-flow" title="Direct link to heading">​</a></h2><p>The authorization flow for a public client (SPA) using PKCE (Proof Key for Code Exchange) is shown here:    </p><div class="tabs-container"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LplD tabs__item--active">Sequence</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LplD">Mermaid</li></ul><div class="margin-vert--md"><div role="tabpanel"><p><a target="_blank" href="/assets/files/okta-ad-sso-authorization-flow-760ab053c2fea594de308cd833cf8975.svg"><img loading="lazy" alt="Okta AD SSO Authorization Flow" src="/assets/images/okta-ad-sso-authorization-flow-760ab053c2fea594de308cd833cf8975.svg" width="1501" height="785" class="img_E7b_"></a></p></div><div role="tabpanel" hidden=""><div class="codeBlockContainer_I0IT language-mermaid theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-mermaid codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">sequenceDiagram;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  %%{init: {&#x27;theme&#x27;: &#x27;base&#x27;, &#x27;themeVariables&#x27;: { &#x27;primaryColor&#x27;: &#x27;#AACCFF&#x27;, &#x27;primaryBorderColor&#x27;: &#x27;#999000&#x27;, &#x27;actorLineColor&#x27;: &#x27;#000000&#x27; }}}%%;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  participant user as User;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  participant spa as User Agent (SPA);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  participant be as Back End APIs;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  participant okta as Okta;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  participant msft as Microsoft Login;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  user-&gt;&gt;spa: ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  spa-&gt;&gt;okta: local.okta.com/../authorize;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Note over spa,okta: includes client_id (okta), code_challenge (PKCE), redirect_uri (to app), response_type, scope</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  okta--&gt;&gt;spa: 302 REDIRECT; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  spa-&gt;&gt;msft: login.microsoftonline.com/../authorize;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Note over spa,msft: includes client_id (msft app id), state, redirect_uri (to okta), response_type, scope</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  msft-&gt;&gt;msft: authenticate;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  msft--&gt;&gt;okta: local.okta.com/../authorize/callback;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  okta--&gt;&gt;msft:  302 REDIRECT;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  msft--&gt;&gt;spa: app/callback?code=xxx;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  spa-&gt;&gt;okta: exchange code for an access token;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  okta-&gt;&gt;spa: token;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  spa-&gt;&gt;be: present token to access resources;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="next-up">Next up<a class="hash-link" href="#next-up" title="Direct link to heading">​</a></h2><p><code>Code!</code>  Stay tuned...</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/okta">okta</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/azure">azure</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/active-directory">active directory</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/azure-active-directory">azure active directory</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/sso">sso</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/single-sign-on">single sign on</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/identity">identity</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about Simple SSO with an external IdP using Active Directory and Okta" href="/simple-sso-with-an-external-idp-using-active-directory-and-okta"><b>Read More</b></a></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Blog</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/">Home</a></li><li class="footer__item"><a class="footer__link-item" href="/archive">Archive</a></li><li class="footer__item"><a class="footer__link-item" href="/tags">Tags</a></li></ul></div><div class="col footer__col"><div class="footer__title">Sponsors</div><ul class="footer__items"><li class="footer__item"><a href="https://stackql.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">StackQL<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://gammadata.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Gamma Data<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.windrate.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">WindRate<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/stackql/fullstackchronicles.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div></div></footer></div>
<script src="/assets/js/runtime~main.f10100e0.js"></script>
<script src="/assets/js/main.29d6b400.js"></script>
</body>
</html>